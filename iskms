# 检查系统是否为 Volume 批量授权版（VOL），是否支持 KMS 激活

# 创建临时文件保存输出
$tmpFile = "$env:TEMP\slmgr_dlv_output.txt"

# 执行 slmgr /dlv 命令，并重定向输出到临时文件
cscript.exe //nologo C:\Windows\System32\slmgr.vbs /dlv > $tmpFile

# 读取文件内容
$content = Get-Content $tmpFile -Raw

# 检查 Description 中是否包含 "VOLUME"
if ($content -match "Description:\s+.*VOLUME") {
    Write-Host "✅ 当前系统是 VOL 版本，支持 KMS 激活。" -ForegroundColor Green
} else {
    Write-Host "❌ 当前系统不是 VOL 版本，不支持 KMS 激活。" -ForegroundColor Red
}

# 删除临时文件
Remove-Item $tmpFile -Force

